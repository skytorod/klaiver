<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.test.mapper.SearchMapper">
	<select id="list" resultType="SearchVO">
		SELECT one.username,one.email,one.profimg,
		ka.compname_kr, ka.compname_en,
		ka.businessType, ka.repname,
		ka.businessname,ka.main_product,
		ka.establish, ka.employees, ka.homepage, ka.businessStatus,
		ka.take, ka.capital, ka.netincome,
		ka.certificationStatus,ka.AboutUs, kp.product, kp.product_en,
		kp.usage,
		kp.pcod, kc.phonenumber, kc.fax,
		kc.cemail, kc.address, kc.organizationChart
		FROM
		k_joinone one JOIN k_about ka
		ON one.email = ka.userid
		join k_product kp
		on ka.userid = kp.userid
		join k_contact kc
		on kp.userid = kc.userid
		where  
		one.username LIKE CONCAT('%', #{keyword}, '%') or one.email LIKE CONCAT('%', #{keyword}, '%') 
		or ka.compname_kr LIKE CONCAT('%', #{keyword}, '%')
		or ka.compname_en LIKE CONCAT('%', #{keyword}, '%')or ka.businessType LIKE CONCAT('%', #{keyword}, '%')
		or ka.repname LIKE CONCAT('%', #{keyword}, '%')or ka.businessname LIKE CONCAT('%', #{keyword}, '%')
		or ka.main_product LIKE CONCAT('%', #{keyword}, '%')or ka.establish LIKE CONCAT('%', #{keyword}, '%')
		or ka.employees LIKE CONCAT('%', #{keyword}, '%')or ka.homepage LIKE CONCAT('%', #{keyword}, '%')
		or ka.businessStatus LIKE CONCAT('%', #{keyword}, '%')or ka.take LIKE CONCAT('%', #{keyword}, '%')
		or ka.capital LIKE CONCAT('%', #{keyword}, '%')or ka.netincome LIKE CONCAT('%', #{keyword}, '%')
		or ka.certificationStatus LIKE CONCAT('%', #{keyword}, '%')or ka.AboutUs LIKE CONCAT('%', #{keyword}, '%')
		or kp.product LIKE CONCAT('%', #{keyword}, '%')or kp.product_en LIKE CONCAT('%', #{keyword}, '%')
		or kp.usage LIKE CONCAT('%', #{keyword}, '%')or kp.pcod LIKE CONCAT('%', #{keyword}, '%')
		or kc.phonenumber LIKE CONCAT('%', #{keyword}, '%')or kc.fax LIKE CONCAT('%', #{keyword}, '%')
		or kc.cemail LIKE CONCAT('%', #{keyword}, '%')or kc.address LIKE CONCAT('%', #{keyword}, '%')
		or kc.organizationChart LIKE CONCAT('%', #{keyword}, '%')
		GROUP BY one.one_id DESC
		limit 0,5 ;
	</select>
	<select id="listsolo" resultType="SearchVO">
	SELECT email,username,profimg
		FROM
		k_joinone 
		where  
		username LIKE CONCAT('%', #{keyword}, '%') or email LIKE CONCAT('%', #{keyword}, '%') 
		GROUP BY  one_id DESC
		limit 0,5 ;
	</select>
	<select id="searchproduct" resultType="K_productVO">
	select 
		pid,userid,image,product,product_en,`usage`,pcod ,pinfo
		from 
		k_product 
		where 
		product LIKE CONCAT('%', #{keyword}, '%') or product_en LIKE CONCAT('%', #{keyword}, '%') 
		or `usage` LIKE CONCAT('%', #{keyword}, '%') or pcod LIKE CONCAT('%', #{keyword}, '%') 
		or pinfo LIKE CONCAT('%', #{keyword}, '%') 
		GROUP BY  pid DESC
		limit 0,5 ;
	</select>
	<select id="listSearch" resultType="SearchVO">
		SELECT one.username,one.email,one.profimg,
		ka.compname_kr, ka.compname_en,
		ka.businessType, ka.repname,
		ka.businessname,ka.main_product,
		ka.establish, ka.employees, ka.homepage, ka.businessStatus,
		ka.take, ka.capital, ka.netincome,
		ka.certificationStatus,ka.AboutUs, kp.product, kp.product_en,
		kp.usage,
		kp.pcod, kc.phonenumber, kc.fax,
		kc.cemail, kc.address, kc.organizationChart
		FROM
		k_joinone one JOIN k_about ka
		ON one.email = ka.userid
		join k_product kp
		on ka.userid = kp.userid
		join k_contact kc
		on kp.userid = kc.userid
		where  
		one.username LIKE CONCAT('%', #{keyword}, '%') or one.email LIKE CONCAT('%', #{keyword}, '%') 
		or ka.compname_kr LIKE CONCAT('%', #{keyword}, '%')
		or ka.compname_en LIKE CONCAT('%', #{keyword}, '%')or ka.businessType LIKE CONCAT('%', #{keyword}, '%')
		or ka.repname LIKE CONCAT('%', #{keyword}, '%')or ka.businessname LIKE CONCAT('%', #{keyword}, '%')
		or ka.main_product LIKE CONCAT('%', #{keyword}, '%')or ka.establish LIKE CONCAT('%', #{keyword}, '%')
		or ka.employees LIKE CONCAT('%', #{keyword}, '%')or ka.homepage LIKE CONCAT('%', #{keyword}, '%')
		or ka.businessStatus LIKE CONCAT('%', #{keyword}, '%')or ka.take LIKE CONCAT('%', #{keyword}, '%')
		or ka.capital LIKE CONCAT('%', #{keyword}, '%')or ka.netincome LIKE CONCAT('%', #{keyword}, '%')
		or ka.certificationStatus LIKE CONCAT('%', #{keyword}, '%')or ka.AboutUs LIKE CONCAT('%', #{keyword}, '%')
		or kp.product LIKE CONCAT('%', #{keyword}, '%')or kp.product_en LIKE CONCAT('%', #{keyword}, '%')
		or kp.usage LIKE CONCAT('%', #{keyword}, '%')or kp.pcod LIKE CONCAT('%', #{keyword}, '%')
		or kc.phonenumber LIKE CONCAT('%', #{keyword}, '%')or kc.fax LIKE CONCAT('%', #{keyword}, '%')
		or kc.cemail LIKE CONCAT('%', #{keyword}, '%')or kc.address LIKE CONCAT('%', #{keyword}, '%')
		or kc.organizationChart LIKE CONCAT('%', #{keyword}, '%')
		GROUP BY one.one_id DESC
		limit #{pageStart},#{perPageNum} ;

	</select>
	<select id="listSearchCount" resultType="int">
		SELECT count(distinct one.username)  FROM
		k_joinone one JOIN k_about ka
		ON one.email = ka.userid
		join k_product kp
		on ka.userid = kp.userid
		join k_contact kc
		on kp.userid = kc.userid
		where  
		one.username LIKE CONCAT('%', #{keyword}, '%') or one.email LIKE CONCAT('%', #{keyword}, '%') 
		or ka.compname_kr LIKE CONCAT('%', #{keyword}, '%')
		or ka.compname_en LIKE CONCAT('%', #{keyword}, '%')or ka.businessType LIKE CONCAT('%', #{keyword}, '%')
		or ka.repname LIKE CONCAT('%', #{keyword}, '%')or ka.businessname LIKE CONCAT('%', #{keyword}, '%')
		or ka.main_product LIKE CONCAT('%', #{keyword}, '%')or ka.establish LIKE CONCAT('%', #{keyword}, '%')
		or ka.employees LIKE CONCAT('%', #{keyword}, '%')or ka.homepage LIKE CONCAT('%', #{keyword}, '%')
		or ka.businessStatus LIKE CONCAT('%', #{keyword}, '%')or ka.take LIKE CONCAT('%', #{keyword}, '%')
		or ka.capital LIKE CONCAT('%', #{keyword}, '%')or ka.netincome LIKE CONCAT('%', #{keyword}, '%')
		or ka.certificationStatus LIKE CONCAT('%', #{keyword}, '%')or ka.AboutUs LIKE CONCAT('%', #{keyword}, '%')
		or kp.product LIKE CONCAT('%', #{keyword}, '%')or kp.product_en LIKE CONCAT('%', #{keyword}, '%')
		or kp.usage LIKE CONCAT('%', #{keyword}, '%')or kp.pcod LIKE CONCAT('%', #{keyword}, '%')
		or kc.phonenumber LIKE CONCAT('%', #{keyword}, '%')or kc.fax LIKE CONCAT('%', #{keyword}, '%')
		or kc.cemail LIKE CONCAT('%', #{keyword}, '%')or kc.address LIKE CONCAT('%', #{keyword}, '%')
		or kc.organizationChart LIKE CONCAT('%', #{keyword}, '%');
	</select>
	<select id="listSearchproductCriteria" resultType="K_productVO">
	select 
		pid,userid,image,product,product_en,`usage`,pcod ,pinfo
		from 
		k_product 
		where 
		product LIKE CONCAT('%', #{keyword}, '%') or product_en LIKE CONCAT('%', #{keyword}, '%') 
		or `usage` LIKE CONCAT('%', #{keyword}, '%') or pcod LIKE CONCAT('%', #{keyword}, '%') 
		or pinfo LIKE CONCAT('%', #{keyword}, '%') 
		GROUP BY  pid DESC
		limit #{pageStart},#{perPageNum} ;
	</select>
	<select id="listSearchproductCount" resultType="int">
		select 
		count(distinct pid)
		from 
		k_product 
		where 
		product LIKE CONCAT('%', #{keyword}, '%') or product_en LIKE CONCAT('%', #{keyword}, '%') 
		or `usage` LIKE CONCAT('%', #{keyword}, '%') or pcod LIKE CONCAT('%', #{keyword}, '%')
		or pinfo LIKE CONCAT('%', #{keyword}, '%')  ;
	</select>  
	<select id="listsoloSearchCriteria" resultType="SearchVO">
	SELECT email,username,profimg
		FROM
		k_joinone 
		where  
		username LIKE CONCAT('%', #{keyword}, '%') or email LIKE CONCAT('%', #{keyword}, '%') 
		GROUP BY  one_id DESC
		limit #{pageStart},#{perPageNum};
	</select>
	<select id="listsoloSearchCount" resultType="int">
	SELECT
		count(distinct one_id)
		FROM
		k_joinone 
		where  
		username LIKE CONCAT('%', #{keyword}, '%') or email LIKE CONCAT('%', #{keyword}, '%');
	</select>
</mapper>